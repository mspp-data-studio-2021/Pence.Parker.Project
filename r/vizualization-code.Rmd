---
title: "vizualization-code"
author: "Pence"
date: "7/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("maps")
library(maps)
#install.packages("tmap")
library(tmap)
#install.packages("plotly")
library(plotly)

```


```{r}
cc_districts_sf  <- read_sf("data/nycc_21b")
```

```{r}
permits_sf <- st_as_sf(permits_joined, coords = c("Longitude", "Latitude"), crs = 4326)

permits_sf_ny <- st_transform(permits_sf, 2263)
```

```{r}
permits_landmarks_sf <- st_as_sf(permits_landmarks, coords = c("Longitude", "Latitude"), crs = 4326)

permits_landmarks_sf_ny <- st_transform(permits_landmarks_sf, 2263)
```

```{r}
permits_sf_ny$address <- paste(permits_sf_ny$AddressNum, permits_sf_ny$AddressSt)
permits_landmarks_sf_ny$address <- paste(permits_landmarks_sf_ny$AddressNum, permits_landmarks_sf_ny$AddressSt)
```


```{r}
tmap_mode("view")
Housing_Map<-tm_basemap("Esri.WorldGrayCanvas")+
  tm_shape(permits_sf_ny)+
tm_bubbles(col = "ClassANet",
           alpha= 0.5,
           size = "ClassANet",
           style="fixed",
           breaks=seq(0, 1500, by=300),
           id="address",
           scale = 0.2,
           border.lwd = 1,
          title.col="Net Housing",
		    popup.vars=c("Council Member: "="council.member", "Permit Year: "="PermitYear","Net Housing: "="ClassANet"),
		    popup.format=list(PermitYear=list(fun=function(PermitYear)formatC(PermitYear, digits=0, format="d"))),
		   shapes.legend = "ClassANet" )+
  tm_shape(permits_landmarks_sf_ny)+
tm_bubbles(col = "ClassANet",
           id= "address",
           alpha= 0.5,
           size = "ClassANet",
           style="fixed",
           breaks=seq(0, 1500, by=300),
           scale = 0.2,
           border.lwd = 1,
           title.col="Net Housing",
		    popup.vars=c("Council Member: "="council.member", "Permit Year: "="PermitYear","Net Housing: "="ClassANet"),
		    popup.format=list(PermitYear=list(fun=function(PermitYear)formatC(PermitYear, digits=0, format="d"))))+
tm_shape(cc_districts_sf)+
  tm_text("CounDist")+
tm_borders(alpha=1)
  

tmap_save(Housing_Map, "C:/Users/waddes/Documents/GitHub/Pence.Parker.Project/images/Housing_Map.html")
```
